<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="mypageMapper">

	<resultMap type="MyPage" id="mypage_rm">
		<id property="memberNo" column="MEMBER_NO"/>
		<result property="profileImage" column="PROFILE_IMG"/>
		<result property="backgroundImage" column="BACKGROUND_IMG"/>
		<result property="memberInfo" column="MEMBER_INFO"/>
		<result property="memberCareer" column="MEBMER_CAREER"/>
		<result property="memberTech" column="MEMBER_TECH"/>
		<result property="certificateNo" column="CERTIFICATE_NO"/>
	
	</resultMap>

	<!-- 회원 정보 수정 -->
	<update id="updateInfo" parameterType="Member">
		UPDATE "MEMBER" SET
		MEMBER_NICKNAME = #{memberNickname},
		MEMBER_URL = #{memberUrl}
		WHERE MEMBER_NO = #{memberNo}
	</update>
	
	
	<!-- 조회 결과가 1개인 경우(int, string 등)
		또는 조회 결과를 모두 Map에 담는 경우
		resultType을 사용
	 -->
	<select id="selectEncPw" parameterType="_int" resultType="string">
		SELECT MEMBER_PW FROM "MEMBER" WHERE MEMBER_NO = #{memberNo}
	</select>
	
	
	<!-- 비밀번호 변경 -->
	<!-- member : 사용자 지정 별칭 (mybatis-config.xml) -->
	<update id="changePw" parameterType="Member">
		UPDATE "MEMBER" SET
		MEMBER_PW = #{memberPw}
		WHERE MEMBER_NO = #{memberNo}
	</update>
	
	
	<!-- 회원 탈퇴 -->
	<update id="secession" parameterType="_int">
		UPDATE "MEMBER" SET
		MEMBER_DEL_FL = 'Y'
		WHERE MEMBER_NO = #{memberNo}
	</update>
	
	
	<!-- 프로필 이미지 수정 -->
	<update id="updateProfileImage">
		UPDATE "MEMBER" SET
		PROFILE_IMG = #{profileImage}
		WHERE MEMBER_NO = #{memberNo}
	</update>
	
	<!-- 배경화면 수정 -->
	<update id="backgroundUpdate">
		UPDATE "MEMBER_PROFILE" SET
		BACKGROUND_IMG = #{backgroundImage}
		WHERE MEMBER_NO = #{memberNo}
	</update>
	
	<!-- 배경화면 삽입 -->
	<insert id="backgroundInsert">
		INSERT INTO "MEMBER_PROFILE"("MEMBER_NO", "BACKGROUND_IMG")
		VALUES(#{memberNo}, #{backgroundImage})
	</insert>
	
	<!-- 내 정보 조회하기 -->
	<select id="selectMemberProfile" resultMap="mypage_rm">
		SELECT MEMBER_NO, PROFILE_IMG, BACKGROUND_IMG, MEMBER_INFO, MEBMER_CAREER, MEMBER_TECH, CERTIFICATE_NO  
		FROM "MEMBER_PROFILE"
		WHERE MEMBER_NO = #{memberNo}
	</select>
</mapper>
